var af;!function(r){"undefined"!=typeof acf?((af={forms:{},setup_form:function(e){var t=e.attr("data-key"),a={$el:e,key:t,submissionSteps:[]};this.pages.initialize(a),this.ajax.initialize(a),this.forms[t]=a;var n=this;a.$el.on("submit",function(e){e.preventDefault(),af.lock(a);e=a.$el.data("acf");e&&e.set("status",""),acf.validation.fetch({form:a.$el,failure:function(){af.unlock(a)},success:function(){var e=a.submissionSteps.slice();n.executeSubmissionSteps(a,e)}})}),acf.doAction("af/form/setup",a)},lock(e){e.$el.find(".af-submit-button").prop("disabled",!0),acf.validation.lockForm(e.$el)},unlock(e){e.$el.find(".af-submit-button").prop("disabled",!1),acf.validation.unlockForm(e.$el)},addSubmissionStep(e,t,a){for(var n={priority:t,fn:a},i=0;i<e.submissionSteps.length;i++)if(t<e.submissionSteps[i].priority)return void e.submissionSteps.splice(i,0,n);e.submissionSteps.push(n)},executeSubmissionSteps(e,t){function a(){af.lock(e),e.$el.get(0).submit()}var n,i,s;0!=t.length?(n=t.shift(),i=this,s=0==t.length?a:function(){i.executeSubmissionSteps(e,t)},n.fn(s)):a()}}).pages={initialize:function(s){var e,o,t=this;$page_fields=s.$el.find(".acf-field-page"),$page_fields.exists()&&(s.pages=[],s.current_page=0,s.max_page=0,s.show_numbering=!0,s.$page_wrap=r('<div class="af-page-wrap">'),s.$page_wrap.insertBefore($page_fields.first()),s.$previous_button=$page_fields.first().find(".af-previous-button"),s.$next_button=$page_fields.first().find(".af-next-button"),s.show_numbering="true"===$page_fields.first().find(".af-page-button").attr("data-show-numbering"),s.$previous_button.click(function(e){e.preventDefault(),t.previousPage(s)}),s.$next_button.click(function(e){e.preventDefault(),t.nextPage(s)}),(e=s.$el.find(".af-submit")).prepend(s.$next_button),e.prepend(s.$previous_button),s.$submit_button=e.find(".af-submit-button"),o=0,$page_fields.each(function(e,t){var a=r(t),n=o,i=a.nextUntil(".acf-field-page",".acf-field");0!=i.length&&((t=a.find(".af-page-button").attr("data-index",n)).click(function(e){e.preventDefault(),af.pages.navigateToPage(n,s)}),s.show_numbering&&($index=r('<span class="index">').html(n+1),t.prepend($index)),s.$page_wrap.append(t),s.pages.push({$field:a,$fields:i,$button:t}),o++)}),this.refresh(s))},refresh:function(n){r.each(n.pages,function(e,t){var a=e==n.current_page;t.$button.toggleClass("enabled",e<=n.max_page),t.$button.toggleClass("current",a),t.$fields.each(function(){r(this).toggle(a)})});var e=this.isFirstPage(n),t=this.isLastPage(n);n.$previous_button.attr("disabled",!!e||null),n.$next_button.toggle(!t),n.$submit_button.toggle(t)},nextPage:function(e){var t;this.isLastPage(e)||(t=this).validatePage(e,e.current_page,function(){t.changePage(e.current_page+1,e)})},previousPage:function(e){this.isFirstPage(e)||this.changePage(e.current_page-1,e)},navigateToPage:function(e,t){var a;e<0||e>t.max_page||(a=this).validatePage(t,t.current_page,function(){a.changePage(e,t)})},changePage:function(e,t){var a=t.current_page;t.current_page=e,t.max_page<=t.current_page&&(t.max_page=t.current_page),this.refresh(t),acf.doAction("af/form/page_changed",e,a,t)},isFirstPage:function(e){return 0==e.current_page},isLastPage:function(e){return e.current_page==e.pages.length-1},validatePage:function(t,a,e){t.pages[a].$fields.find("input").each(function(){this.checkValidity()});function n(e){for(i=0;i<t.pages.length;i++)i!=a&&e(t.pages[i])}n(function(e){e.$fields.detach()});function s(){n(function(e){e.$fields.insertAfter(e.$field)})}acf.validation.fetch({form:t.$el,lock:!1,reset:!0,success:function(){s(),e()},failure:function(){s()}})}},af.ajax={initialize:function(t){var a=this;t.$el.is("[data-ajax]")&&af.addSubmissionStep(t,100,function(e){a.sendSubmission(t)})},sendSubmission:function(e){var t=new FormData(e.$el.get(0));t.append("action","af_submission"),r.ajax({url:acf.get("ajaxurl"),data:t,processData:!1,contentType:!1,type:"post",success:this.onSuccess(e),error:this.onError(e),complete:function(){af.unlock(e)}})},onSuccess:function(n){return function(e){var t=e.data;switch(acf.doAction("af/form/ajax/submission",t,n),t.type){case"success_message":var a=r(t.success_message);n.$el.find(".af-fields").replaceWith(a);break;case"redirect":window.location.href=t.redirect_url}}},onError:function(a){return function(e){var t=a.$el.data("acf"),e=e.responseJSON.data.errors;t.addErrors(e),t.showErrors()}}},r(document).ready(function(){r(".af-form").each(function(){af.setup_form(r(this))})})):console.error("acf-input.js not found. AF requires ACF to work.")}(jQuery);